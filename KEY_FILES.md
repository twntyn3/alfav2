# üéØ –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∞–ø–≥—Ä–µ–π–¥–∞ –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π

## –¢–æ–ø-5 —Ñ–∞–π–ª–æ–≤ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞

### 1. üî• `configs/models.yaml` - –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ú–û–î–ï–õ–ï–ô
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô  
**–ß—Ç–æ –º–µ–Ω—è—Ç—å**: 
- `embeddings.model_name` ‚Üí `BAAI/bge-m3` (–∏–ª–∏ cohere)
- `reranker.model_name` ‚Üí `BAAI/bge-reranker-v2-m3`
- `reranker_ensemble.enabled` ‚Üí `true`
- `reranker_ensemble.second_pass` ‚Üí `true`

**–û–∂–∏–¥–∞–µ–º—ã–π –ø—Ä–∏—Ä–æ—Å—Ç**: +7-12% Hit@5

---

### 2. üî• `src/retriever.py` - HYBRID RETRIEVER
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô  
**–°—Ç—Ä–æ–∫–∏ –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏**: 
- 29: `embedding_model_name` - –∑–¥–µ—Å—å –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –º–æ–¥–µ–ª—å –¥–ª—è embeddings
- 96-104: `_build_router_config()` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ FlashRAG router

**–ß—Ç–æ —É–ª—É—á—à–∏—Ç—å**:
- –ó–∞–º–µ–Ω–∏—Ç—å `intfloat/multilingual-e5-large` –Ω–∞ `BAAI/bge-m3`
- –£–ª—É—á—à–∏—Ç—å RRF fusion –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –î–æ–±–∞–≤–∏—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é —Å–∫–æ—Ä–æ–≤ –ø–µ—Ä–µ–¥ fusion

**–û–∂–∏–¥–∞–µ–º—ã–π –ø—Ä–∏—Ä–æ—Å—Ç**: +5-8% Hit@5

---

### 3. üî• `src/reranker.py` - RERANKER
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô  
**–°—Ç—Ä–æ–∫–∏ –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏**:
- 25: `model_name` - –º–æ–¥–µ–ª—å –¥–ª—è reranking
- 48: `CrossReranker(config)` - —Å–æ–∑–¥–∞–Ω–∏–µ reranker'–∞

**–ß—Ç–æ —É–ª—É—á—à–∏—Ç—å**:
- –ó–∞–º–µ–Ω–∏—Ç—å `BAAI/bge-reranker-base` –Ω–∞ `BAAI/bge-reranker-v2-m3`
- –£–≤–µ–ª–∏—á–∏—Ç—å `max_length` –¥–æ 8192 (–µ—Å–ª–∏ –º–æ–¥–µ–ª—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å batch processing

**–û–∂–∏–¥–∞–µ–º—ã–π –ø—Ä–∏—Ä–æ—Å—Ç**: +4-6% Hit@5

---

### 4. üî• `src/reranker_ensemble.py` - ENSEMBLE RERANKER
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –í–´–°–û–ö–ò–ô  
**–°—Ç—Ä–æ–∫–∏ –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏**:
- 72-80: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è rerankers
- 118-154: –õ–æ–≥–∏–∫–∞ batch_rerank —Å ensemble

**–ß—Ç–æ —É–ª—É—á—à–∏—Ç—å**:
- –í–∫–ª—é—á–∏—Ç—å –≤ `configs/models.yaml`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–≤–µ —Å–∏–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏
- –í–∫–ª—é—á–∏—Ç—å second-pass reranking

**–û–∂–∏–¥–∞–µ–º—ã–π –ø—Ä–∏—Ä–æ—Å—Ç**: +3-5% Hit@5

---

### 5. ‚ö° `src/table_processor.py` - QUERY ENHANCEMENT
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –°–†–ï–î–ù–ò–ô  
**–°—Ç—Ä–æ–∫–∏ –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏**:
- 216-501: –§—É–Ω–∫—Ü–∏—è `enhance_query_for_numerics()`

**–ß—Ç–æ —É–ª—É—á—à–∏—Ç—å**:
- –î–æ–±–∞–≤–∏—Ç—å LLM-based query expansion (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ–ø–µ—á–∞—Ç–æ–∫
- –†–∞—Å—à–∏—Ä–∏—Ç—å —Å–ª–æ–≤–∞—Ä—å —Å–∏–Ω–æ–Ω–∏–º–æ–≤ (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)

**–û–∂–∏–¥–∞–µ–º—ã–π –ø—Ä–∏—Ä–æ—Å—Ç**: +1-3% Hit@5

---

## üìä –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤

| –§–∞–π–ª | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ü—Ä–∏—Ä–æ—Å—Ç | –í—Ä–µ–º—è –∞–ø–≥—Ä–µ–π–¥–∞ |
|------|-----------|---------|----------------|
| `configs/models.yaml` | üî• –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô | +7-12% | 5 –º–∏–Ω |
| `src/retriever.py` | üî• –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô | +5-8% | 30 –º–∏–Ω |
| `src/reranker.py` | üî• –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô | +4-6% | 15 –º–∏–Ω |
| `src/reranker_ensemble.py` | ‚ö° –í–´–°–û–ö–ò–ô | +3-5% | 10 –º–∏–Ω |
| `src/table_processor.py` | ‚öôÔ∏è –°–†–ï–î–ù–ò–ô | +1-3% | 1 —á–∞—Å |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –®–∞–≥ 1: –û–±–Ω–æ–≤–∏—Ç—å –º–æ–¥–µ–ª–∏ –≤ –∫–æ–Ω—Ñ–∏–≥–µ (5 –º–∏–Ω—É—Ç)
```yaml
# configs/models.yaml
embeddings:
  model_name: "BAAI/bge-m3"  # –≤–º–µ—Å—Ç–æ multilingual-e5-large

reranker:
  model_name: "BAAI/bge-reranker-v2-m3"  # –≤–º–µ—Å—Ç–æ bge-reranker-base
  max_length: 8192  # –≤–º–µ—Å—Ç–æ 512

reranker_ensemble:
  enabled: true  # –≤–∫–ª—é—á–∏—Ç—å!
  models:
    - "BAAI/bge-reranker-v2-m3"
    - "BAAI/bge-reranker-base"
  weights: [0.7, 0.3]
  second_pass: true
  second_pass_topk: 20
```

### –®–∞–≥ 2: –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏–Ω–¥–µ–∫—Å (30-60 –º–∏–Ω—É—Ç)
```bash
make clean
make build_index
```

### –®–∞–≥ 3: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
```bash
make quick_test
make eval
```

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `src/retriever.py` –∏ `src/reranker.py` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å FlashRAG API
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ embedding –º–æ–¥–µ–ª–∏ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å FAISS –∏–Ω–¥–µ–∫—Å
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ reranker –º–æ–¥–µ–ª–∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞
- Ensemble reranker —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ 50-100%

